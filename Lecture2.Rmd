---
title: "Lecture2"
author: "Олексій Ігнатенко"
date: "September 14, 2019"
output:
  ioslides_presentation:
    widescreen: true
    smaller: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Мова R та IDE R Studio. Перший погляд.

*Що таке R?*

Це просте питання. Відповідь: R - це діалект S.

*А що таке S?*

S - це мова програмування, розроблена John Chambers та іншими в лабораторії Bell Telephone, яка була частиною AT&T Corp. S з'явився в 1976, як внутрішня оболонка для статистичного аналізу і спочатку була бібліотекою, написаною на Фортрані.

## Розвиток S 

В 1988 систему переписали на C і вона стала схожа на сьогоднішню. В 1998 вийшла четверта версія мови S. В 1993 Bell Labs
віддали компанії StatSci (пізніше Insightful Corp.) ексклюзивні права розробку S. В 2004 Insight купила мову S у Lucent Technologies за \$ 2 мільйони. Insightful видала свою імплементацію S під назвою S-PLUS. В 2008 Insightful була куплена за  \$25 million. 

R є безкоштовним варіантом S, який втім розвивається власним шляхом.


## R є вільним продуктом

* The freedom to run the program, for any purpose (freedom 0).
* The freedom to study how the program works, and adapt it to your needs (freedom 1). Access
to the source code is a precondition for this.
* The freedom to redistribute copies so you can help your neighbor (freedom 2).
* The freedom to improve the program, and release your improvements to the public, so that
the whole community benefits (freedom 3). Access to the source code is a precondition for
this.

## Вміст R 

Система R складається з двох частин: 

1. База R. system that you download from CRAN: Linux16 Windows17 Mac18 Source Code19
2. Все інше 

Функціональність розбита так: 

* База вілповідальна за найбільш фундаментальні функції. 
* Все інше - окремими пакетами.
* На сьогодні є більш як 4000 пакетів у репозиторію CRAN (офіційний репозиторій)
* Ще більше пакетів є на гітхабі - пакети, які пишуть люди для себе і інших

## Середовище

```{r}
getwd()
#setwd()
```


## R - калькулятор

```{r}
2 + 3
2* 6
1/0
```

## R - калькулятор

```{r}
num <- 6
num ^ 2
num
```
```{r}
num <- num ^ 2 * 5 + 10 / 3
num

```

## Об'єкти в R

R має п'ять базових "атомарних" класів:

* символьний
* числовий (дійсні числа)
* цілі числа
* комплексні числа
* логічний (True/False)

Найбільш базовий тип - вектор. Все в R - це вектори. Є єдине правило - вектори мають містити об'єкти одного класу. 
Але є одне виключення. Список - вектор з різнотипними об'єктами 

## Структури даних в R

Головні структури даних такі:

* Вектори
* Масиви і матриці
* Списки
* Датафрейми

## R - вектори

```{r}
x <- 1:5
y <- c(6, 7, 8 ,9, 10)
```

```{r, eval=FALSE}
x + y
x*y
```

## R - вектори

спробуйте передбачити результат

```{r,eval=FALSE}
c(1,3,5,7,9) * 2
c(1,3,5,7,9) * c(2, 4)
factorial(1:5)
cos(c(0, pi/4))
sum(1:10)
```

## Спеціальні символи

```{r}
1 / 0

0 / 0

Inf / NaN

Inf / Inf

log(Inf)

Inf + NA

```

## Спробуйте передбачити результат

```{r,eval=FALSE}
vec <- c(0, Inf, NaN, NA)

is.finite(vec)
is.nan(vec)
is.na(vec)
is.infinite(vec)
```

## Перетворення класів

```{r}
x <- 0:6
class(x)
as.numeric(x)
as.logical(x)
as.character(x)
```

## Перетворення класів

```{r}
x <- c("a", "b", "c")
as.numeric(x)
as.logical(x)
as.complex(x)
```

## Матриці

Матриці - це вектори з атрибутом розмірність. Атрибут розмірність - це вектор цілих чисел розмірності 2 (кількість рядків, кількість стовпців) 

```{r}
m <- matrix(nrow = 2, ncol = 3)
m

m <- matrix(1:6, nrow = 2, ncol = 3)
m
```
## Є і інші способи визначення матриць

Додати атрибут розмірності до вектора

```{r}
m <- 1:10
m
dim(m) <- c(2,5)
m
```

## Є і інші способи визначення матриць

або зклеїти за допомогою функцій cbind() та rbind()

```{r}
x <- 1:3
y <- 10:12
cbind(x, y)
rbind(x, y)
```

## Звернення до елементів матриці

```{r}
A <- matrix(1:6, nrow = 2, ncol = 3)
A
A[,2]
A[1,]
diag(x=A)
```
## Звернення до елементів матриці

```{r,eval=FALSE}
A[,-2]
A[-1,3:2]
A[-1,-2]
A[-1,-c(2,3)]
```
## Завдання для розминки мозку

1. Створіть матрицю 4 × 2, яку наповніть (порядково) наступними елементами: 4.3, 3.1, 8.2, 8.2, 3.2, 0.9, 1.6, 6.5.
2. Покажіть, що якщо видалити окремий рядок, то розмірність матриці буде 3 × 2.
3. Перепишіть другий стовпець матриці вектором з тими ж значеннями, але відсортованим від меншого до більшого. 
4. Яким буде результат, якщо видалити четвертий рядок результату 3. та перший стовпець? Покажіть, що це буде саме матриця а не вектор. 
5. Запишіть чотири нижніх елемента 3. в нову матрицю 2 × 2. 
6. Перезапишіть діагональні елементи значеннями -2 -3.

Час 2 хв.

## Матричні функції

Транспонування
```{r}
t(A)
B <- t(A)
```
Діагональна матриця

```{r}
A <- diag(x=3)
A
```

## Матричні операції

```{r,eval=FALSE}
a <- 2
B <- a * A
A + B
A * B
A - B
```

## Множення матриць

```{r}
A <- diag(x=3)
B <- A + 1
C <- A %*% B
solve(C)
```
## Логічні змінні

```{r}
x <- TRUE
y <- T
z <- 1
x * y * z == TRUE
```

## Завдання

Визначте вектор з 15 значень c(6,9,7,3,6,7,9,6,3,6,6,7,1,9,1). Виберіть елементи, які:

* Рівні 6

* Більше або рівні 6

* Непарні 

* Не рівні 6

* Діляться на три 

## Підмножини

```{r}
myvec <- c(5,-2.3,4,4,4,6,8,10,40221,-8)
myvec[c(F,T,F,F,F,F,F,F,F,T)]
myvec<0
myvec[myvec<0]
myvec[-which(x=myvec<0)]
```


## Списки - особливий тип векторів

```{r}
x <- list(1, "a", TRUE, 1 + 4i)
x
```

## Факторні вектори

Фактори корисні для роботи з категоріальними даними (наприклад відповіді на анкету). Можна уявляти їх вектором з цілих чисел, де кожне число має окрему позначку. 

```{r}
x <- factor(c("yes", "yes", "no", "yes", "no"))
x
table(x)
unclass(x)
```
## Корисні функції

```{r,eval=FALSE}
seq()
rep()
length()

```

## Завдання. Зробити за мінімальну кількість символів

1. Отримати наступні послідовності:

* Всі непарні числа від 1 до 100

* Всі числа, що кратні 5 від 1 до 200

* Як зробити послідовність 1 2 3 4 5 6 7 8 9 10 9 8 7 6 5 4 3 2 1?

* Як зробити послідовність 2 4 6 8 10 1 3 5 7 9?


## Датафрейми - головна робоча конячка R

Посилання https://data.rada.gov.ua/open/data/mps-skl9

```{r}
setwd("/Users/anymac/Downloads")
df <- read.csv("mps09-data.csv")
str(df)
```

## Підсумок

```{r}
summary(df$first_name)
```

## Розминка. 

* Які дані присутні в цьому датасеті.
* Придумайте змістовне запитання щодо даних
* Які типи стовпців датафрейму?
* Як підрахувати гендерний склад по фракціям?

## Деякі можливості

```{r,eval=FALSE}
library(jpeg)
myurl <- df$photo[5]
z <- tempfile()
download.file(as.character(myurl),z)
pic <- readJPEG(z)
file.remove(z)
```

## Фото
```{r,eval=FALSE}
plot(c(100, 250), c(300, 450), type = "n", xlab = "", ylab = "")
rasterImage(pic, 100, 300, 120, 450, interpolate = FALSE)
```

## Що ми можемо дізнатись про народних депутатів?

```{r}
l <- table(df$party_name)
l / length(df$id) * 100
```

## Дні, місяці і роки народження

1. Перетворити на дату
2. Оцінити середній вік
3. Знайти у скількох депутатів ДР у один день

```{r}
df$birthday

```

